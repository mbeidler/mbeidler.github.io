<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>The Bank OCR Kata in Haskell - Part 2</title>
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../site.css" />
  </head>
  <body>
    <div class="navbar navbar-inverse">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../">&lambda;</a>
      </div>
      <div class="navbar-collapse collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav">
          <li>
            <a href="../about.html">About</a>
          </li>
        </ul>
      </div>
    </div>
      <div class="container">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">The Bank OCR Kata in Haskell - Part 2</h3>
    </div>
    <div class="panel-body">
      
        <div style="font-weight: bold;">September 19, 2014</div>
      
      
      
        <div style="padding-top: 10px;">
          <span class="badge tag"><a href="../tags/Haskell.html">Haskell</a></span><span class="badge tag"><a href="../tags/Kata.html">Kata</a></span>
        </div>
        <br />
      

      <p>Another placeholder with some sample Haskell code to test syntax highlighting.</p>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">BankOCR</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Char</span> (digitToInt)
<span class="kw">import </span><span class="dt">Data.List</span> (transpose)
<span class="kw">import </span><span class="dt">Test.Hspec</span>

bankOCRSpec <span class="fu">=</span> hspec <span class="fu">$</span> <span class="kw">do</span>
  describe <span class="st">&quot;When parsing human readable account numbers&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
    it <span class="st">&quot;should parse 000000000&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
      parse zeros <span class="ot">`shouldBe`</span> <span class="dv">0</span>
    it <span class="st">&quot;should parse 111111111&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
      parse ones <span class="ot">`shouldBe`</span> <span class="dv">111111111</span>
    it <span class="st">&quot;should parse 123456789&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
      parse oneToNine <span class="ot">`shouldBe`</span> <span class="dv">123456789</span>
    it <span class="st">&quot;should validate the checksum&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
      isValid <span class="dv">711111111</span> <span class="ot">`shouldBe`</span> <span class="dt">True</span>

zeros <span class="fu">=</span> unlines
  [ <span class="st">&quot;                           &quot;</span>
  , <span class="st">&quot; _  _  _  _  _  _  _  _  _ &quot;</span>
  , <span class="st">&quot;| || || || || || || || || |&quot;</span>
  , <span class="st">&quot;|_||_||_||_||_||_||_||_||_|&quot;</span> ]

ones <span class="fu">=</span> unlines
  [ <span class="st">&quot;                           &quot;</span>
  , <span class="st">&quot;                           &quot;</span>
  , <span class="st">&quot;  |  |  |  |  |  |  |  |  |&quot;</span>
  , <span class="st">&quot;  |  |  |  |  |  |  |  |  |&quot;</span> ]

oneToNine <span class="fu">=</span> unlines
  [ <span class="st">&quot;                           &quot;</span>
  , <span class="st">&quot;    _  _     _     _  _  _ &quot;</span>
  , <span class="st">&quot;  | _| _||_||_ |_   ||_||_|&quot;</span>
  , <span class="st">&quot;  ||_  _|  | _||_|  ||_| _|&quot;</span> ]


<span class="ot">parse ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>
parse <span class="fu">=</span> foldl f <span class="dv">0</span> <span class="fu">.</span> prep
  <span class="kw">where</span>
    prep <span class="fu">=</span> toCell <span class="fu">.</span> concat <span class="fu">.</span> transpose <span class="fu">.</span> map triples <span class="fu">.</span> tail <span class="fu">.</span> lines
    f n cell <span class="fu">=</span> <span class="kw">let</span> r' <span class="fu">=</span> p' cell <span class="kw">in</span> r' <span class="fu">+</span> <span class="dv">10</span> <span class="fu">*</span> n

<span class="ot">p' ::</span> [<span class="dt">Char</span>] <span class="ot">-&gt;</span> <span class="dt">Int</span>
p' <span class="st">&quot; _ | ||_|&quot;</span> <span class="fu">=</span> <span class="dv">0</span>
p' <span class="st">&quot;     |  |&quot;</span> <span class="fu">=</span> <span class="dv">1</span>
p' <span class="st">&quot; _  _||_ &quot;</span> <span class="fu">=</span> <span class="dv">2</span>
p' <span class="st">&quot; _  _| _|&quot;</span> <span class="fu">=</span> <span class="dv">3</span>
p' <span class="st">&quot;   |_|  |&quot;</span> <span class="fu">=</span> <span class="dv">4</span>
p' <span class="st">&quot; _ |_  _|&quot;</span> <span class="fu">=</span> <span class="dv">5</span>
p' <span class="st">&quot;   |_ |_|&quot;</span> <span class="fu">=</span> <span class="dv">6</span>
p' <span class="st">&quot; _   |  |&quot;</span> <span class="fu">=</span> <span class="dv">7</span>
p' <span class="st">&quot; _ |_||_|&quot;</span> <span class="fu">=</span> <span class="dv">8</span>
p' <span class="st">&quot; _ |_| _|&quot;</span> <span class="fu">=</span> <span class="dv">9</span>
p' _           <span class="fu">=</span> error <span class="st">&quot;unknown symbol&quot;</span>

<span class="ot">triples ::</span> [a] <span class="ot">-&gt;</span> [[a]]
triples (a<span class="fu">:</span>b<span class="fu">:</span>c<span class="fu">:</span>xs) <span class="fu">=</span> [a,b,c] <span class="fu">:</span> triples xs
triples _          <span class="fu">=</span> []

<span class="ot">toCell ::</span> [[a]] <span class="ot">-&gt;</span> [[a]]
toCell (a<span class="fu">:</span>b<span class="fu">:</span>c<span class="fu">:</span>xs) <span class="fu">=</span> (a <span class="fu">++</span> (b <span class="fu">++</span> c)) <span class="fu">:</span> toCell xs
toCell _          <span class="fu">=</span> []

<span class="ot">isValid ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>
isValid n <span class="fu">=</span> num <span class="ot">`mod`</span> <span class="dv">11</span> <span class="fu">==</span> <span class="dv">0</span>
  <span class="kw">where</span> 
    num <span class="fu">=</span> sum [ i <span class="fu">*</span> (digitToInt d) <span class="fu">|</span> (i,d) <span class="ot">&lt;-</span> zip [<span class="dv">1</span><span class="fu">..</span><span class="dv">9</span>] (reverse <span class="fu">.</span> show <span class="fu">$</span> n) ]</code></pre>
    </div>
  </div>
</div>

    <footer class="container">
      <div class="panel panel-default">
        <div class="panel-body">
          Site proudly generated by
          <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          <div class="pull-right">
            Source available on <a href="http://www.github.com/mbeidler/mbeidler.github.io">GitHub</a>
          </div>
        </div>
      </div>
    </footer>
    <script type="text/javascript" src="../js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../js/bootstrap.min.js"></script>
  </body>
</html>
